<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>C·ª≠a h√†ng V√°n</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #fff; margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        
        /* THANH TR∆Ø·ª¢T NGANG CH·ª®A V√ÅN */
        .carousel-container {
            flex: 1; display: flex; align-items: center;
            overflow-x: auto; scroll-snap-type: x mandatory;
            padding: 20px 0; gap: 30px; scrollbar-width: none;
        }
        .carousel-container::-webkit-scrollbar { display: none; }

        .item-wrapper {
            flex: 0 0 160px; scroll-snap-align: center;
            display: flex; flex-direction: column; align-items: center;
            transition: 0.3s;
        }

        /* KHUNG H√åNH CH·ªÆ NH·∫¨T CH·ª®A V√ÅN (GI·ªêNG ·∫¢NH) */
        .paddle-box {
            width: 150px; height: 80px; border: 2px solid #333;
            display: flex; justify-content: center; align-items: center;
            position: relative; background: #f9f9f9; border-radius: 5px;
        }
        .paddle-visual { width: 120px; height: 12px; border-radius: 6px; }
        .lock-overlay { position: absolute; font-size: 24px; top: 10px; }

        /* TR·∫†NG TH√ÅI D∆Ø·ªöI M·ªñI √î */
        .status-label { margin-top: 10px; font-weight: bold; font-size: 16px; text-align: center; }
        .price-label { font-weight: bold; color: #333; margin-top: 5px; }

        /* KHUNG HI·ªÇN TH·ªä CHI TI·∫æT D∆Ø·ªöI C√ôNG */
        .detail-panel {
            padding: 20px; background: #fff; border-top: 2px solid #000;
            text-align: left; min-height: 150px;
        }
        .stat-highlight { color: #a855f7; font-weight: bold; font-size: 20px; margin-bottom: 15px; }

        .btn-upgrade {
            border: 2px solid #000; background: #fff; padding: 5px 20px;
            font-weight: bold; font-size: 18px; cursor: pointer;
        }
        .btn-upgrade:disabled { color: #ccc; border-color: #ccc; }

        /* NAVIGATION */
        .bottom-nav {
            display: flex; justify-content: space-between;
            padding: 20px 40px; border-top: 2px solid #000;
            font-weight: bold; font-size: 22px;
        }
    </style>
</head>
<body>

    <div class="carousel-container" id="carousel">
        </div>

    <div class="detail-panel">
        <div id="selected-status" style="font-weight:bold; font-size:18px;">---</div>
        <div id="selected-stat" class="stat-highlight">Ch·ªâ s·ªë</div>
        <div id="upgrade-area">
            <button id="btn-main" class="btn-upgrade" onclick="handleAction()">N√¢ng c·∫•p</button>
        </div>
    </div>

    <div class="bottom-nav">
        <div onclick="location.href='index.html'">Quay l·∫°i</div>
        <div style="color: #000;">Kho ƒë·ªì</div>
    </div>

<script>
    const paddles = [
        { id: 'default', name: 'M·∫∑c ƒë·ªãnh', cap: 100, price: 0, color: '#000', lv: 0 },
        { id: 'iron', name: 'V√°n S·∫Øt', cap: 250, price: 500, color: '#757575', lv: 1 },
        { id: 'pink', name: 'V√°n H·ªìng', cap: 450, price: 1200, color: '#ff69b4', lv: 2 },
        { id: 'gold', name: 'V√°n V√†ng', cap: 1000, price: 5000, color: '#ffa500', lv: 3 }
    ];

    let currentIdx = 0;
    let myMaxLv = parseInt(localStorage.getItem('userMaxLv')) || 0; 
    let myCoins = 1000; // Duy thay b·∫±ng code l·∫•y xu t·ª´ Firebase

    function render() {
        const carousel = document.getElementById('carousel');
        carousel.innerHTML = paddles.map((p, i) => `
            <div class="item-wrapper" onclick="select(${i})">
                <div class="paddle-box" style="${i === currentIdx ? 'border-width:4px;' : ''}">
                    <div class="paddle-visual" style="background:${p.color}"></div>
                    ${p.lv > myMaxLv ? '<div class="lock-overlay">üîí</div>' : ''}
                </div>
                <div class="status-label">${p.lv <= myMaxLv ? (localStorage.getItem('selectedPaddle') === p.id ? 'ƒêang s·ª≠ d·ª•ng' : 'ƒê√£ m·ªü') : '[Gi√°]'}</div>
                <div class="price-label">${p.lv <= myMaxLv ? '' : p.price + ' Xu'}</div>
            </div>
        `).join('');
        updateDetail();
    }

    function select(i) {
        currentIdx = i;
        render();
    }

    function updateDetail() {
        const p = paddles[currentIdx];
        const statusText = document.getElementById('selected-status');
        const statText = document.getElementById('selected-stat');
        const btn = document.getElementById('btn-main');

        statText.innerText = `S·ª©c ch·ª©a: ${p.cap}kg`;

        if (p.lv <= myMaxLv) {
            statusText.innerText = "S·∫µn s√†ng s·ª≠ d·ª•ng";
            btn.innerText = "Trang b·ªã";
            btn.disabled = false;
        } else if (p.lv === myMaxLv + 1) {
            statusText.innerText = "C√≥ th·ªÉ n√¢ng c·∫•p";
            btn.innerText = "N√¢ng c·∫•p";
            btn.disabled = myCoins < p.price;
        } else {
            statusText.innerText = "B·ªã kh√≥a";
            btn.innerText = "Ch∆∞a th·ªÉ m·ªü";
            btn.disabled = true;
        }
    }

    function handleAction() {
        const p = paddles[currentIdx];
        if (p.lv <= myMaxLv) {
            localStorage.setItem('selectedPaddle', p.id);
            alert("ƒê√£ thay ƒë·ªïi v√°n!");
        } else {
            // Logic n√¢ng c·∫•p (Tr·ª´ ti·ªÅn, tƒÉng Level)
            myMaxLv = p.lv;
            localStorage.setItem('userMaxLv', myMaxLv);
            // C·∫≠p nh·∫≠t Firebase t·∫°i ƒë√¢y
            alert("N√¢ng c·∫•p th√†nh c√¥ng!");
        }
        render();
    }

    render();
</script>
</body>
</html>
